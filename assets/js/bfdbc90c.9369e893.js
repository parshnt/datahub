"use strict";(self.webpackChunkdocs_website=self.webpackChunkdocs_website||[]).push([[3713],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var u=a.createContext({}),l=function(e){var t=a.useContext(u),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=l(e.components);return a.createElement(u.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,u=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),c=l(n),h=o,m=c["".concat(u,".").concat(h)]||c[h]||p[h]||r;return n?a.createElement(m,i(i({ref:t},d),{},{components:n})):a.createElement(m,i({ref:t},d))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,i=new Array(r);i[0]=c;var s={};for(var u in t)hasOwnProperty.call(t,u)&&(s[u]=t[u]);s.originalType=e,s.mdxType="string"==typeof e?e:o,i[1]=s;for(var l=2;l<r;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},45318:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var a=n(87462),o=(n(67294),n(3905));const r={title:"Adding Users to DataHub",slug:"/authentication/guides/add-users",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/authentication/guides/add-users.md"},i="Adding Users to DataHub",s={unversionedId:"docs/authentication/guides/add-users",id:"docs/authentication/guides/add-users",title:"Adding Users to DataHub",description:"Users can log into DataHub in 3 ways:",source:"@site/genDocs/docs/authentication/guides/add-users.md",sourceDirName:"docs/authentication/guides",slug:"/authentication/guides/add-users",permalink:"/docs/authentication/guides/add-users",draft:!1,editUrl:"https://github.com/datahub-project/datahub/blob/master/docs/authentication/guides/add-users.md",tags:[],version:"current",frontMatter:{title:"Adding Users to DataHub",slug:"/authentication/guides/add-users",custom_edit_url:"https://github.com/datahub-project/datahub/blob/master/docs/authentication/guides/add-users.md"},sidebar:"overviewSidebar",previous:{title:"Quickstart Guide",permalink:"/docs/quickstart"},next:{title:"Adding Users to DataHub",permalink:"/docs/authentication/guides/add-users"}},u={},l=[{value:"Send prospective users an invite link",id:"send-prospective-users-an-invite-link",level:2},{value:"Reset password for native users",id:"reset-password-for-native-users",level:2},{value:"Changing the default &#39;datahub&#39; user",id:"changing-the-default-datahub-user",level:2},{value:"Create a user.props file to add new users",id:"create-a-userprops-file-to-add-new-users",level:2},{value:"(Advanced) Mount custom user.props file to container",id:"advanced-mount-custom-userprops-file-to-container",level:2},{value:"Docker Compose",id:"docker-compose",level:3},{value:"Helm",id:"helm",level:3},{value:"URNs",id:"urns",level:2},{value:"Caveats",id:"caveats",level:2},{value:"Adding User Details",id:"adding-user-details",level:3},{value:"URNs",id:"urns-1",level:2},{value:"FAQ",id:"faq",level:2},{value:"Feedback / Questions / Concerns",id:"feedback--questions--concerns",level:2}],d={toc:l};function p(e){let{components:t,...r}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,r,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"adding-users-to-datahub"},"Adding Users to DataHub"),(0,o.kt)("p",null,"Users can log into DataHub in 3 ways:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Invite users via the UI"),(0,o.kt)("li",{parentName:"ol"},"Static credentials"),(0,o.kt)("li",{parentName:"ol"},"Single Sign-On via ",(0,o.kt)("a",{parentName:"li",href:"https://www.google.com/search?q=openid+connect&oq=openid+connect&aqs=chrome.0.0i131i433i512j0i512l4j69i60l2j69i61.1468j0j7&sourceid=chrome&ie=UTF-8"},"OpenID Connect")," (For Production Use)")),(0,o.kt)("p",null,"which can be enabled simultaneously. Options 1 and 2 are useful for running proof-of-concept exercises, or just getting DataHub up & running quickly. Option 3 is highly recommended for deploying DataHub in production."),(0,o.kt)("h1",{id:"method-1-inviting-users-via-the-datahub-ui"},"Method 1: Inviting users via the DataHub UI"),(0,o.kt)("h2",{id:"send-prospective-users-an-invite-link"},"Send prospective users an invite link"),(0,o.kt)("p",null,"With the right permissions (",(0,o.kt)("inlineCode",{parentName:"p"},"MANAGE_USER_CREDENTIALS"),"), you can invite new users to your deployed DataHub instance from the UI. It's as simple as sending a link!"),(0,o.kt)("p",null,"First navigate, to the Users and Groups tab (under Access) on the Settings page. You'll then see an ",(0,o.kt)("inlineCode",{parentName:"p"},"Invite Users")," button. Note that this will only be clickable\nif you have the correct permissions."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(51873).Z,width:"1903",height:"357"})),(0,o.kt)("p",null,"If you click on this button, you'll see a pop-up where you can copy an invite link to send to users, or generate a fresh one."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(1336).Z,width:"765",height:"345"})),(0,o.kt)("p",null,"When a new user visits the link, they will be directed to a sign up screen. Note that if a new link has since been regenerated, the new user won't be able to sign up!"),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(85637).Z,width:"494",height:"777"})),(0,o.kt)("h2",{id:"reset-password-for-native-users"},"Reset password for native users"),(0,o.kt)("p",null,"If a user forgets their password, an admin user with the ",(0,o.kt)("inlineCode",{parentName:"p"},"MANAGE_USER_CREDENTIALS")," privilege can go to the Users and Groups tab and click on the respective user's\n",(0,o.kt)("inlineCode",{parentName:"p"},"Reset user password")," button."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(19895).Z,width:"1607",height:"78"})),(0,o.kt)("p",null,"Similar to the invite link, you can generate a new reset link and send a link to that user which they can use to reset their credentials."),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(23449).Z,width:"759",height:"332"})),(0,o.kt)("p",null,"When that user visits the link, they will be direct to a screen where they can reset their credentials. If the link is older than 24 hours or another link has since\nbeen generated, they won't be able to reset their credentials!"),(0,o.kt)("p",null,(0,o.kt)("img",{src:n(98905).Z,width:"498",height:"602"})),(0,o.kt)("h1",{id:"method-2-configuring-static-credentials"},"Method 2: Configuring static credentials"),(0,o.kt)("h2",{id:"changing-the-default-datahub-user"},"Changing the default 'datahub' user"),(0,o.kt)("p",null,"The 'datahub' admin user is created for you by default. To override that user please follow these steps. This is due to the way the authentication setup is working - we support a \"default\" user.props containing the root datahub user and a separate custom file, which does not overwrite the first. "),(0,o.kt)("p",null,"However, it's still possible to change the password for the default ",(0,o.kt)("inlineCode",{parentName:"p"},"datahub user"),". To change it, follow these steps:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Update the ",(0,o.kt)("inlineCode",{parentName:"li"},"docker-compose.yaml")," to mount your default user.props file to the following location inside the ",(0,o.kt)("inlineCode",{parentName:"li"},"datahub-frontend-react")," container using a volume:\n",(0,o.kt)("inlineCode",{parentName:"li"},"/datahub-frontend/conf/user.props")),(0,o.kt)("li",{parentName:"ol"},"Restart the datahub containers to pick up the new configs ")),(0,o.kt)("p",null,"If you're deploying using the CLI quickstart, you can simply download a copy of the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/datahub-project/datahub/blob/master/docker/quickstart/docker-compose.quickstart.yml"},"docker-compose file used in quickstart"),",\nand modify the ",(0,o.kt)("inlineCode",{parentName:"p"},"datahub-frontend-react")," block to contain the extra volume mount. Then simply run"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"datahub docker quickstart \u2014quickstart-compose-file <your-modified-compose>.yml\n")),(0,o.kt)("h2",{id:"create-a-userprops-file-to-add-new-users"},"Create a user.props file to add new users"),(0,o.kt)("p",null,"To define a set of username / password combinations that should be allowed to log in to DataHub, create a new file called ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props")," at the file path ",(0,o.kt)("inlineCode",{parentName:"p"},"${HOME}/.datahub/plugins/frontend/auth/user.props"),'.\nThis file should contain username:password combinations, with 1 user per line. For example, to create 2 new users,\nwith usernames "janesmith" and "johndoe", we would define the following file:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"janesmith:janespassword\njohndoe:johnspassword\n")),(0,o.kt)("p",null,"Once you've saved the file, simply start the DataHub containers & navigate to ",(0,o.kt)("inlineCode",{parentName:"p"},"http://localhost:9002/login"),"\nto verify that your new credentials work."),(0,o.kt)("p",null,"To change or remove existing login credentials, edit and save the ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props")," file. Then restart DataHub containers. "),(0,o.kt)("p",null,"If you want to customize the location of the ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props")," file, or if you're deploying DataHub via Helm, proceed to Step 2."),(0,o.kt)("h2",{id:"advanced-mount-custom-userprops-file-to-container"},"(Advanced) Mount custom user.props file to container"),(0,o.kt)("p",null,"This step is only required when mounting custom credentials into a Kubernetes pod (e.g. Helm) ",(0,o.kt)("strong",{parentName:"p"},"or")," if you want to change\nthe default filesystem location from which DataHub mounts a custom ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props")," file (",(0,o.kt)("inlineCode",{parentName:"p"},"${HOME}/.datahub/plugins/frontend/auth/user.props)"),". "),(0,o.kt)("p",null,"If you are deploying with ",(0,o.kt)("inlineCode",{parentName:"p"},"datahub docker quickstart"),", or running using Docker Compose, you can most likely skip this step."),(0,o.kt)("h3",{id:"docker-compose"},"Docker Compose"),(0,o.kt)("p",null,"You'll need to modify the ",(0,o.kt)("inlineCode",{parentName:"p"},"docker-compose.yml")," file to mount a container volume mapping your custom user.props to the standard location inside the container\n(",(0,o.kt)("inlineCode",{parentName:"p"},"/etc/datahub/plugins/frontend/auth/user.props"),")."),(0,o.kt)("p",null,"For example, to mount a user.props file that is stored on my local filesystem at ",(0,o.kt)("inlineCode",{parentName:"p"},"/tmp/datahub/user.props"),", we'd modify the YAML for the\n",(0,o.kt)("inlineCode",{parentName:"p"},"datahub-web-react")," config to look like the following:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-aidl"},"  datahub-frontend-react:\n    build:\n      context: ../\n      dockerfile: docker/datahub-frontend/Dockerfile\n    image: linkedin/datahub-frontend-react:${DATAHUB_VERSION:-head}\n    .....\n    # The new stuff\n    volumes:\n      - ${HOME}/.datahub/plugins:/etc/datahub/plugins\n      - /tmp/datahub:/etc/datahub/plugins/frontend/auth\n")),(0,o.kt)("p",null,"Once you've made this change, restarting DataHub enable authentication for the configured users."),(0,o.kt)("h3",{id:"helm"},"Helm"),(0,o.kt)("p",null,"You'll need to create a Kubernetes secret, then mount the file as a volume to the ",(0,o.kt)("inlineCode",{parentName:"p"},"datahub-frontend")," pod. "),(0,o.kt)("p",null,"First, create a secret from your local ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props")," file"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create secret generic datahub-users-secret --from-file=user.props=./<path-to-your-user.props>\n")),(0,o.kt)("p",null,"Then, configure your ",(0,o.kt)("inlineCode",{parentName:"p"},"values.yaml")," to add the volume to the ",(0,o.kt)("inlineCode",{parentName:"p"},"datahub-frontend")," container."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-YAML"},"datahub-frontend:\n  ...\n  extraVolumes:\n    - name: datahub-users\n      secret:\n        defaultMode: 0444\n        secretName:  datahub-users-secret\n  extraVolumeMounts:\n    - name: datahub-users\n      mountPath: /etc/datahub/plugins/frontend/auth/user.props\n      subPath: user.props\n")),(0,o.kt)("p",null,"Note that if you update the secret you will need to restart the ",(0,o.kt)("inlineCode",{parentName:"p"},"datahub-frontend")," pods so the changes are reflected. To update the secret in-place you can run something like this."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl create secret generic datahub-users-secret --from-file=user.props=./<path-to-your-user.props> -o yaml --dry-run=client | kubectl apply -f -\n")),(0,o.kt)("h2",{id:"urns"},"URNs"),(0,o.kt)("p",null,"URNs are identifiers that uniquely identify an Entity on DataHub. The usernames defined in the ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props"),' file will be used to generate the DataHub user "urn", which uniquely identifies\nthe user on DataHub. The urn is computed as:'),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"urn:li:corpuser:{username}\n")),(0,o.kt)("h2",{id:"caveats"},"Caveats"),(0,o.kt)("h3",{id:"adding-user-details"},"Adding User Details"),(0,o.kt)("p",null,"If you add a new username / password to the ",(0,o.kt)("inlineCode",{parentName:"p"},"user.props")," file, no other information about the user will exist\nabout the user in DataHub (full name, email, bio, etc). This means that you will not be able to search to find the user."),(0,o.kt)("p",null,"In order for the user to become searchable, simply navigate to the new user's profile page (top-right corner) and click\n",(0,o.kt)("strong",{parentName:"p"},"Edit Profile"),". Add some details like a display name, an email, and more. Then click ",(0,o.kt)("strong",{parentName:"p"},"Save"),". Now you should be able\nto find the user via search."),(0,o.kt)("blockquote",null,(0,o.kt)("p",{parentName:"blockquote"},"You can also use our Python Emitter SDK to produce custom information about the new user via the CorpUser metadata entity.")),(0,o.kt)("p",null,"For a more comprehensive overview of how users & groups are managed within DataHub, check out ",(0,o.kt)("a",{parentName:"p",href:"https://www.youtube.com/watch?v=8Osw6p9vDYY"},"this video"),"."),(0,o.kt)("h1",{id:"method-3-configuring-sso-via-openid-connect"},"Method 3: Configuring SSO via OpenID Connect"),(0,o.kt)("p",null,"Setting up SSO via OpenID Connect means that users will be able to login to DataHub via a central Identity Provider such as"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Azure AD"),(0,o.kt)("li",{parentName:"ul"},"Okta "),(0,o.kt)("li",{parentName:"ul"},"Keycloak"),(0,o.kt)("li",{parentName:"ul"},"Ping!"),(0,o.kt)("li",{parentName:"ul"},"Google Identity")),(0,o.kt)("p",null,"and more. "),(0,o.kt)("p",null,"This option is recommended for production deployments of DataHub. For detailed information about configuring DataHub to use OIDC to\nperform authentication, check out ",(0,o.kt)("a",{parentName:"p",href:"/docs/authentication/guides/sso/configure-oidc-react"},"OIDC Authentication"),". "),(0,o.kt)("h2",{id:"urns-1"},"URNs"),(0,o.kt)("p",null,"URNs are identifiers that uniquely identify an Entity on DataHub. The username received from an Identity Provider\nwhen a user logs into DataHub via OIDC is used to construct a unique identifier for the user on DataHub. The urn is computed as:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"urn:li:corpuser:<extracted-username>\n")),(0,o.kt)("p",null,"For information about configuring which OIDC claim should be used as the username for Datahub, check out the ",(0,o.kt)("a",{parentName:"p",href:"/docs/authentication/guides/sso/configure-oidc-react"},"OIDC Authentication")," doc."),(0,o.kt)("h2",{id:"faq"},"FAQ"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"Can I enable OIDC and username / password (JaaS) authentication at the same time? ")),(0,o.kt)("p",null,"YES! If you have not explicitly disabled JaaS via an environment variable on the datahub-frontend container (AUTH",(0,o.kt)("em",{parentName:"p"},"JAAS_ENABLED),\nthen you can _always")," access the standard login flow at ",(0,o.kt)("inlineCode",{parentName:"p"},"http://your-datahub-url.com/login"),". "),(0,o.kt)("h2",{id:"feedback--questions--concerns"},"Feedback / Questions / Concerns"),(0,o.kt)("p",null,"We want to hear from you! For any inquiries, including Feedback, Questions, or Concerns, reach out on Slack!"))}p.isMDXComponent=!0},51873:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/invite-users-button-c7e1dc8a61fb3955845e1fb56ced5e37.png"},1336:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/invite-users-popup-67c00dba01e7065d99f12eef908923cd.png"},98905:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/reset-credentials-screen-f63fc1fb8e0515635b8ebe3337c67c5e.png"},19895:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/reset-user-password-button-fe679aad1d664c65a4b199c2685823dd.png"},23449:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/reset-user-password-popup-eb3ea0b359f962648798f3ce80b75453.png"},85637:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/user-sign-up-screen-d6a9861679a9daf3f1ac6a968c968fa2.png"}}]);